#!/bin/sh

timestamp=$(git log -1 --format="%at" HEAD)
datestring=$(date -d @$timestamp -Idate)

version=$(git describe --dirty)
if [ $? -eq 128 ]; then
  version="0-$(git describe --always --dirty)"
fi

cat >$1 <<EOF
# This file is generated by utils/generate-version as part of the
# Makefile / CI system. Please do not commit it.

variables:
  runtime-version: '${version}'
  runtime-version-date: '${datestring}'
EOF
