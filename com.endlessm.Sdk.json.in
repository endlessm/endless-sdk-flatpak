{
    "build-runtime": true,
    "id": "com.endlessm.Sdk",
    "id-platform": "com.endlessm.Platform",
    "branch": "@@SDK_BRANCH@@",
    "runtime": "org.gnome.Platform",
    "sdk": "org.gnome.Sdk",
    "runtime-version": "@@GNOME_RUNTIME_VERSION@@",
    "sdk-extensions": ["org.gnome.Sdk.Debug", "org.gnome.Sdk.Locale"],
    "runtime-extensions": ["org.gnome.Platform.Locale"],
    "metadata": "metadata.sdk",
    "metadata-platform": "metadata.platform",
    "cleanup": [ "/cache",
                 "/man",
                 "/share/man",
                 "/lib/systemd",
                 "*.la", "*.a"],
    "cleanup-commands": [ "touch -d @0 /usr/share/fonts",
                          "touch -d @0 /usr/share/fonts/*",
                          "fc-cache -fs"
                        ],
    "cleanup-platform": [ "/include",
                          "/share/aclocal",
                          "/share/pkgconfig",
                          "/lib/pkgconfig",
                          "/share/gir-1.0",
                          "/share/vala"
                        ],
    "cleanup-platform-commands": [ "touch -d @0 /usr/share/fonts",
                                   "touch -d @0 /usr/share/fonts/*",
                                   "fc-cache -fs",
                                   "ldconfig -C /usr/etc/ld.so.cache"
                                 ],
    "build-options": {
        "cflags": "-O2 -g",
        "cxxflags": "-O2 -g",
        "env": {
            "V": "1"
        }
    },

    "modules": [
        {
            "name": "meson",
            "no-autogen": true,
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/mesonbuild/meson/releases/download/0.39.1/meson-0.39.1.tar.gz",
                    "sha256": "44885ccfef94d3d4afb1053fa6673ed130d3093fc9e9f6624d08161d8a385220"
                },
                {
                    "type": "patch",
                    "path": "meson-glib-check.patch",
                    "strip-components": 0
                },
                {
                    "type": "file",
                    "path": "setuptools-makefile",
                    "dest-filename": "Makefile"
                }
            ]
        },
        {
            "name": "python-polib",
            "no-autogen": true,
            "ensure-writable": ["/lib/python*/site-packages/easy-install.pth"],
            "build-options": {
                "env": {
                    "PYTHON": "/usr/bin/python3"
                }
            },
            "sources": [
                {
                    "type": "archive",
                    "url": "https://pypi.python.org/packages/fb/64/ad3dbcc052d92fedd535a80b9866a9334afaf136cb5d89a673ac36d16b5a/polib-1.0.8.tar.gz#md5=4e7c8a8e6851279ebb7c5813ca48d452",
                    "sha256": "5affe3d915eb5b4773f4ce164817e383eea0306115cdaf9b64008b3aea8202df"
                },
                {
                    "type": "file",
                    "path": "setuptools-makefile",
                    "dest-filename": "Makefile"
                }
            ]
        },
        {
            "name": "libyaml",
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/yaml/libyaml/archive/0.1.7.tar.gz",
                    "sha256": "e1884d0fa1eec8cf869ac6bebbf25391e81956aa2970267f974a9fa5e0b968e2"
                }
            ]
        },
        {
            "name": "python3-pyyaml",
            "no-autogen": true,
            "build-options": {
                "env": {
                    "PYTHON": "/usr/bin/python3"
                }
            },
            "sources": [
                {
                    "type": "archive",
                    "url": "http://pyyaml.org/download/pyyaml/PyYAML-3.12.tar.gz",
                    "sha256": "592766c6303207a20efc445587778322d7f73b161bd994f227adaa341ba212ab"

                },
                {
                    "type": "file",
                    "path": "setuptools-makefile",
                    "dest-filename": "Makefile"
                }
            ]
        },
        {
            "name": "tcl",
            "no-autogen": true,
            "cleanup": ["*"],
            "builddir": false,
            "subdir": "unix",
            "config-opts": [
                "--disable-symbols"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://downloads.sourceforge.net/project/tcl/Tcl/8.6.6/tcl8.6.6-src.tar.gz",
                    "sha256": "a265409781e4b3edcc4ef822533071b34c3dc6790b893963809b9fe221befe07"
                }
            ],
            "post-install": [
                "chmod 0755 /usr/lib/libtcl8.6.so",
                "ln -s /usr/bin/tclsh8.6 /usr/bin/tclsh"
            ]
        },
        {
            "name": "xapian-1.3",
            "subdir": "xapian-core",
            "builddir": false,
            "config-opts": [
                "--enable-maintainer-mode",
                "--disable-documentation"
            ],
            "sources": [
                {
                    "type": "git",
                    "url": "https://github.com/endlessm/xapian-core"
                }
            ]
        },
        {
            "name": "xapian-glib",
            "sources": [
                {
                    "type": "git",
                    "url": "https://github.com/endlessm/xapian-glib"
                }
            ]
        },
        {
            "name": "xapian-bridge",
            "sources": [
                {
                    "type": "git",
                    "url": "https://github.com/endlessm/xapian-bridge"
                }
            ]
        },
        {
            "name": "jasmine-gjs",
            "sources": [
                {
                    "type": "git",
                    "url": "https://github.com/ptomato/jasmine-gjs"
                }
            ]
        },
        {
            "name": "eos-sdk",
            "build-options": {
                "env": {
                    "PYTHON": "python3"
                },
                "config-opts": [
                    "--disable-gtk-doc",
                    "--disable-gir-doc",
                    "--disable-js-doc",
                    "--disable-metrics",
                    "--disable-webhelper"
                ]
            },
            "sources": [
                {
                    "type": "git",
                    "url": "https://github.com/endlessm/eos-sdk"
                }
            ]
        },
        {
            "name": "libsass",
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/sass/libsass/archive/3.4.4.tar.gz",
                    "sha256": "1dc4d49a9a53b891b7e98935709e625f1d68782d87aef4304a41e6d590abb480"
                },
                {
                    "type": "shell",
                    "commands": [ "autoreconf --verbose --force --install" ]
                }
            ]
        },
        {
            "name": "sassc",
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/sass/sassc/archive/3.4.2.tar.gz",
                    "sha256": "ad805f2d404d17cf2980c8079a7413cd58d2f2085120167997b85420a722e079"
                },
                {
                    "type": "shell",
                    "commands": [ "autoreconf --verbose --force --install" ]
                }
            ]
        },
        {
            "name": "eos-shard",
            "sources": [
                {
                    "type": "git",
                    "url": "https://github.com/endlessm/eos-shard.git"
                }
            ]
        },
        {
            "name": "mathjax-js",
            "no-autogen": true,
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/mathjax/MathJax/archive/2.4.0.tar.gz",
                    "sha256": "cd7175e1e352793942a976bf40692b954b5169bd28533921a8a8dd4ec865d855"
                },
                {
                    "type": "file",
                    "path": "mathjax-makefile",
                    "dest-filename": "Makefile"
                }
            ]
        },
        {
            "name": "opus",
            "cleanup": [ "/bin" ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/xiph/opus/releases/download/v1.1.2/opus-1.1.2.tar.gz",
                    "sha256": "0e290078e31211baa7b5886bcc8ab6bc048b9fc83882532da4a1a45e58e907fd"
                }
            ]
        },
        {
            "name": "gstreamer",
            "build-options" : {
                "arch" : {
                    "i386" : {
                        "config-opts" : [
                            "--build=i586-unknown-linux-gnu"
                        ]
                    },
                    "arm" : {
                        "config-opts" : [
                            "--build=arm-unknown-linux-gnueabi"
                        ]
                    }
                }
            },
            "config-opts": ["--enable-experimental", "--enable-orc", "--enable-opus" ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://download.gnome.org/sources/gstreamer/1.11/gstreamer-1.11.2.tar.xz",
                    "sha256": "baa27e761e9d2e1770a8e311b2a61397edd6a288b2ff188940ea001615883305"
                }
            ]
        },
        {
            "name": "gstreamer-plugins-base",
            "build-options" : {
                "arch" : {
                    "i386" : {
                        "config-opts" : [
                            "--build=i586-unknown-linux-gnu"
                        ]
                    },
                    "arm" : {
                        "config-opts" : [
                            "--build=arm-unknown-linux-gnueabi"
                        ]
                    }
                }
            },
            "config-opts": ["--enable-experimental", "--enable-orc", "--enable-opus" ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://download.gnome.org/sources/gst-plugins-base/1.11/gst-plugins-base-1.11.2.tar.xz",
                    "sha256": "7f73876e795dccf8acf1a45148b7cdd32bc618de6cadb049a00ea38111ceebd9"
                }
            ]
        },
        {
            "name": "gstreamer-plugins-good",
            "build-options" : {
                "arch" : {
                    "i386" : {
                        "config-opts" : [
                            "--build=i586-unknown-linux-gnu"
                        ]
                    },
                    "arm" : {
                        "config-opts" : [
                            "--build=arm-unknown-linux-gnueabi"
                        ]
                    }
                }
            },
            "config-opts": ["--enable-experimental", "--enable-orc" ,
                            "--disable-monoscope",
                            "--disable-aalib",
                            "--enable-cairo",
                            "--disable-libcaca",
                            "--disable-jack",
                            "--with-default-visualizer=autoaudiosink" ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://download.gnome.org/sources/gst-plugins-good/1.11/gst-plugins-good-1.11.2.tar.xz",
                    "sha256": "704dadaa6b024bb5cdbdae58d6dabcbc3134294b64555484927a137c5b66ae69"
                }
            ]
        },
        {
            "name": "gstreamer-plugins-bad",
            "build-options" : {
                "arch" : {
                    "i386" : {
                        "config-opts" : [
                            "--build=i586-unknown-linux-gnu"
                        ]
                    },
                    "arm" : {
                        "config-opts" : [
                            "--build=arm-unknown-linux-gnueabi"
                        ]
                    }
                }
            },
            "config-opts": ["--enable-experimental", "--enable-orc" ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://gstreamer.freedesktop.org/src/gst-plugins-bad/gst-plugins-bad-1.11.2.tar.xz",
                    "sha256": "c23fc89a5fdd8e1c77a3b12e8667df33990526c88b328ee7957dbbf9b29cc16a"
                }
            ]
        },
        {
            "name": "appstream",
            "builddir": true,
            "buildsystem": "cmake",
            "build-options": {
                "config-opts": [
                    "-DQT=OFF",
                    "-DAPT_SUPPORT=ON",
                    "-DVAPI=OFF",
                    "-DSTEMMING=OFF"
                ]
            },
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/ximion/appstream/archive/APPSTREAM_0_10_4.tar.gz",
                    "sha256": "0f506ef1146d2bc96c9215368de7e3248a110f4a8b90c6cc80cfe058e9abe33e"
                },
                {
                    "type": "patch",
                    "path": "endless-appstream-cache.patch"
                },
                {
                    "type": "patch",
                    "path": "endless-appstream-no-docs.patch"
                }
            ]
        },
        {
            "name": "emeus",
            "buildtype": "meson",
            "builddir": true,
            "sources": [
                {
                    "type": "git",
                    "url": "https://github.com/ebassi/emeus.git"
                }
            ]
        },
                {
            "name": "popplerdata",
            "no-autogen": true,
            "make-install-args": ["prefix=/usr"],
            "sources": [
                {
                    "type": "archive",
                    "url": "http://poppler.freedesktop.org/poppler-data-0.4.7.tar.gz",
                    "sha256": "e752b0d88a7aba54574152143e7bf76436a7ef51977c55d6bd9a48dccde3a7de"
                }
            ]
        },
        {
            "name": "poppler",
            "config-opts": [ "--disable-libopenjpeg" ],
            "cleanup": [ "/bin" ],
            "sources": [
                {
                    "type": "archive",
                    "url": "http://poppler.freedesktop.org/poppler-0.36.0.tar.xz",
                    "sha256": "93cc067b23c4ef7421380d3e8bd7c940b2027668446750787d7c1cb42720248e"
                }
            ]
        },
        {
            "name": "evince",
            "config-opts": [ "--disable-nautilus", "--enable-introspection" ],
            "cleanup": [ "/bin" ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://download.gnome.org/sources/evince/3.24/evince-3.24.0.tar.xz",
                    "sha256": "043895af7bbd6f1b57f9ab8778e78cf9c0af5dfcc347eaa94a17bf864c04dc8f"
                }
            ]
        },
        {
            "name": "eos-knowledge-lib",
            "cleanup-platform": ["*.scss"],
            "config-opts": [
                "--disable-metrics",
                "--disable-js-doc",
                "--with-mathjax-dir=/usr/share/javascript/mathjax"
            ],
            "sources": [
                {
                    "type": "git",
                    "url": "https://github.com/endlessm/eos-knowledge-lib.git"
                }
            ]
        },
        {
            "name": "os-release",
            "sources": [
                {
                    "type": "file",
                    "path": "os-release"
                },
                {
                    "type": "file",
                    "path": "issue"
                },
                {
                    "type": "file",
                    "path": "issue.net"
                },
                {
                    "type": "file",
                    "path": "com.endlessm.Sdk.appdata.xml"
                },
                {
                    "type": "file",
                    "path": "com.endlessm.Platform.appdata.xml"
                },
                {
                    "type": "file",
                    "path": "os-release-configure",
                    "dest-filename": "configure"
                }
            ]
        }

    ]
}
